/*!*
 * MCalendar v0.6.2 (https://github.com/dengliran/MCalendar.git)
 * Created by Deng Liran on 2017/7
 * Licensed under the MIT license
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.MCalendar=e()}(this,function(){function t(e,a){return this instanceof t?this.init(e,a):new t(e,a)}var e={callback:function(){}},a=!1,n=void 0,r=void 0,d=void 0;return t.prototype.configure=function(t){var a,n;for(a in t)void 0!==(n=t[a])&&t.hasOwnProperty(a)&&(e[a]=n);return this},t.prototype.init=function(t,e){return this.configure(e),this._eventBind(t),this},t.prototype.render=function(t){if(!r||!d){var e=new Date;r=e.getFullYear(),d=e.getMonth()+1}return 0===t?d--:1===t&&d++,0===d&&(d=12,r--),d>12&&(d=1,r++),this._dateModel(r,d)},t.prototype._dateModel=function(t,e){var a=[],n=new Date(t,e-1,1),r=n.getDay();0===r&&(r=7);for(var d=new Date(t,e-1,0),i=d.getDate(),c=r-1,o=new Date(t,e,0),l=o.getDate(),s=0;s<42;s++){var u=s+1-c,h=u,v=e;u<=0?(v=e-1,h=i+u):u>l&&(v=e+1,h-=l),0===v&&(v=12),13===v&&(v=1),a.push({month:v,date:u,showDate:h})}return{year:t,month:e,days:a}},t.prototype.viewManage=function(t){var e=document.createElement("div");e.className="MCalendar-container";e.innerHTML+='<div id="MCalendar-mask"></div>\t\t\t\t<div class="MCalendar-content">\t\t\t\t<div class="MCalendar-hd">\t\t\t\t\t<a href="javascript:;" id="MCalendar__cancel">取消</a>\t\t\t\t\t\t<div class="MCalendar-hd__tools">\t\t\t\t\t\t\t<a href="javascript:;" id="MCalendar-hd__prev">prev</a>\t\t\t\t\t\t\t\t<span id="MCalendar-hd__ym"></span>\t\t\t\t\t\t\t<a href="javascript:;" id="MCalendar-hd__next">next</a>\t\t\t\t\t\t</div>\t\t\t\t\t<a href="javascript:;" id="MCalendar__enter">确认</a>\t\t\t\t</div>\t\t\t\t<table class="MCalendar-bd">\t\t\t\t\t<thead>\t\t\t\t\t\t<tr>\t\t\t\t\t\t\t<th>一</th>\t\t\t\t\t\t\t<th>二</th>\t\t\t\t\t\t\t<th>三</th>\t\t\t\t\t\t\t<th>四</th>\t\t\t\t\t\t\t<th>五</th>\t\t\t\t\t\t\t<th>六</th>\t\t\t\t\t\t\t<th>日</th>\t\t\t\t\t\t</tr>\t\t\t\t\t</thead>\t\t\t\t\t<tbody id="MCalendar-bd__tbody">\t\t\t\t\t</tbody>\t\t\t\t</table>\t\t\t\t<div>\n',document.body.appendChild(e),this.viewBind(t)},t.prototype.viewBind=function(t){for(var e="",a=0;a<t.days.length;a++){var n=t.year+"-"+t.days[a].month+"-"+t.days[a].showDate;a%7==0&&(e+="<tr>"),e+='<td data-current="'+n+'" class="'+(this._checkInSelectedDate(n)?"MCalendar-active":"")+'">'+t.days[a].showDate+"</td>",a%7==6&&(e+="</tr>")}document.getElementById("MCalendar-hd__ym").innerHTML=t.year+"/"+t.month,document.getElementById("MCalendar-bd__tbody").innerHTML=e},t.prototype._checkInSelectedDate=function(t){for(var e=0;e<n.length;e++)if(n[e]===t)return!0;return!1},t.prototype._clearAllSelectedDate=function(){return n=[],this},t.prototype._eventBind=function(t){function r(t){if(!a){n=this.getAttribute("data-selectedDate")?this.getAttribute("data-selectedDate").split(","):[];var r=d.render(),i=t.target;d.viewManage(r),a=!0,document.getElementById("MCalendar-mask").addEventListener("click",function(){document.body.removeChild(document.querySelector(".MCalendar-container")),a=!1,d._clearAllSelectedDate()}),document.getElementById("MCalendar__cancel").addEventListener("click",function(){document.body.removeChild(document.querySelector(".MCalendar-container")),a=!1,d._clearAllSelectedDate()}),document.getElementById("MCalendar-hd__prev").addEventListener("click",function(){var t=d.render(0);d.viewBind(t)}),document.getElementById("MCalendar-hd__next").addEventListener("click",function(){var t=d.render(1);d.viewBind(t)}),document.getElementById("MCalendar-bd__tbody").addEventListener("click",function(t){if("TD"!==t.target.tagName)return!1;if(/MCalendar-active/g.test(t.target.className)){t.target.className=t.target.className.replace("MCalendar-active","");for(var e=0;e<n.length;e++)n[e]===t.target.dataset.current&&n.splice(e,1)}else t.target.className+=" MCalendar-active",n.push(t.target.dataset.current)}),document.getElementById("MCalendar__enter").addEventListener("click",function(){i.value=n.join(","),i.setAttribute("data-selecteddate",n),document.body.removeChild(document.querySelector(".MCalendar-container")),e.callback(n),a=!1})}}for(var d=this,i=document.querySelectorAll(t),c=0;c<i.length;c++)i[c].addEventListener("focus",r)},t});